"use strict";function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _get=function(t,e,r){for(var a=!0;a;){var n=t,i=e,s=r;c=l=o=void 0,a=!1,null===n&&(n=Function.prototype);var c=Object.getOwnPropertyDescriptor(n,i);if(void 0!==c){if("value"in c)return c.value;var o=c.get;return void 0===o?void 0:o.call(s)}var l=Object.getPrototypeOf(n);if(null===l)return void 0;t=l,e=i,r=s,a=!0}},_createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),Map=function(){function t(e){var r=this;_classCallCheck(this,t),this.WIDTH=e.width,this.HEIGHT=.4*e.width,this.scale=this.WIDTH/1e3,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=this.WIDTH,this.canvas.height=this.HEIGHT,e.container.appendChild(this.canvas),this.ctx.drawSvg("world.svg",0,0,this.WIDTH,this.HEIGHT),this.mapDate=this.ctx.getImageData(0,0,this.WIDTH,this.HEIGHT),this.container={},this.count=0,this.particles={},this.particle=function(){var t=0;return function(e,a,n,i,s,c,o,l,u){r.particles[++t]={index:t,x:e,y:a,r:n,o:i,c:s,xv:c,yv:o,rv:l,ov:u}}}()}return _createClass(t,[{key:"trigger",value:function(t,e){t=this.getXY(t),e=this.getXY(e);var r=+new Date,a="#21b384",n="#e32528",i="#F8BD19";if(!this.container[r]){var s={start:t,end:e,startColor:a,endColor:n,particleColor:i,duration:1e3,radius:70+parseInt(20*Math.random()),xv:.02*(t.x-e.x),yv:.02*(t.y-e.y)};this.container[r]=s,this.count++||this.draw()}}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.WIDTH,this.HEIGHT),this.ctx.putImageData(this.mapDate,0,0)}},{key:"draw",value:function(){var t=+new Date;this.clear();var e=!0,r=!1,a=void 0;try{for(var n,i=Object.keys(this.particles)[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){var s=n.value,c=this.particles[s];this.ctx.beginPath(),this.ctx.arc(c.x,c.y,c.r,0,2*Math.PI),this.ctx.globalAlpha=c.o,this.ctx.fillStyle=c.c,this.ctx.fill(),c.x+=c.xv,c.y+=c.yv,c.r+=c.rv,c.o+=c.ov,(c.r<0||c.o<0)&&delete this.particles[c.index]}}catch(o){r=!0,a=o}finally{try{!e&&i["return"]&&i["return"]()}finally{if(r)throw a}}var l=!0,u=!1,h=void 0;try{for(var p,m=Object.keys(this.container)[Symbol.iterator]();!(l=(p=m.next()).done);l=!0){var s=p.value,d=t-s,v=this.container[s];if(d<v.duration){var y=this.easeOutQuint(d,0,v.radius,v.duration),f=v.start.x+d/v.duration*(v.end.x-v.start.x),g=v.start.y+d/v.duration*(v.end.y-v.start.y),x=this.easeOutQuint(d,1,-1,v.duration);this.ctx.globalAlpha=x,this.ctx.strokeStyle=v.startColor,this.ctx.lineWidth=5,this.ctx.beginPath(),this.ctx.arc(v.start.x,v.start.y,y,0,2*Math.PI),this.ctx.stroke();var w=Math.sqrt(v.xv*v.xv+v.yv*v.yv)/5;1>w&&(w=1);for(var b=Math.ceil(w),k=w/b,E=0;b>E;E++)this.particle(f-v.xv*E/b,g-v.yv*E/b,7,k,v.particleColor,.6*Math.random()-.3,.6*Math.random()-.3,-.3,-.05*k)}else if(d<2*v.duration){var y=this.easeOutQuint(d-v.duration,0,v.radius,v.duration),x=this.easeOutQuint(d-v.duration,1,-1,v.duration);this.ctx.globalAlpha=x,this.ctx.strokeStyle=v.endColor,this.ctx.lineWidth=5,this.ctx.beginPath(),this.ctx.arc(v.end.x,v.end.y,y,0,2*Math.PI),this.ctx.stroke()}else delete this.container[s],this.count--}}catch(o){u=!0,h=o}finally{try{!l&&m["return"]&&m["return"]()}finally{if(u)throw h}}this.count&&window.requestAnimationFrame(this.draw.bind(this))}},{key:"getXY",value:function(t){return{x:(2.6938*t.lon+465.4)*this.scale,y:(-2.6938*t.lat+227.066)*this.scale}}},{key:"easeOutQuint",value:function(t,e,r,a){return r*Math.sin(t/a*(Math.PI/2))+e}}]),t}(),AttackList=function(t){function e(){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return _inherits(e,t),_createClass(e,[{key:"render",value:function(){var t=[],e=!0,r=!1,a=void 0;try{for(var n,i=Object.keys(this.props.list)[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){var s=n.value;t.push({country:s,count:this.props.list[s]})}}catch(c){r=!0,a=c}finally{try{!e&&i["return"]&&i["return"]()}finally{if(r)throw a}}return React.createElement("table",{className:this.props.className},React.createElement("tr",null,React.createElement("th",null,"attackorigin"==this.props.className?"Origin":"Targets"),React.createElement("th",null,"Count")),t.sort(function(t,e){return e.count-t.count}).slice(0,9).map(function(t){return React.createElement("tr",null,React.createElement("td",null,t.country),React.createElement("td",null,t.count))}))}}]),e}(React.Component),RealTimeList=function(t){function e(){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return _inherits(e,t),_createClass(e,[{key:"render",value:function(){return React.createElement("table",{className:this.props.className},React.createElement("tr",null,React.createElement("th",null,"Time"),React.createElement("th",null,"Origin"),React.createElement("th",null,"Targets"),React.createElement("th",null,"Type")),this.props.realtime.map(function(t){return React.createElement("tr",null,React.createElement("td",{width:"200"},t.Time),React.createElement("td",null,t.Origin),React.createElement("td",{width:"200"},t.Targets),React.createElement("td",null,t.Type))}))}}]),e}(React.Component),Info=function(t){function e(){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return _inherits(e,t),_createClass(e,[{key:"render",value:function(){return React.createElement("div",{className:"info"},React.createElement(AttackList,{list:this.props.origin,className:"attackorigin"}),React.createElement(AttackList,{list:this.props.targets,className:"attacktargets"}),React.createElement(RealTimeList,{realtime:this.props.realtime,className:"realtime"}))}}]),e}(React.Component),map=new Map({container:document.querySelector(".map"),width:screen.width,worldmap:worldmap}),list=document.querySelector(".list"),origin={},targets={},realtime=[],ws=new WebSocket("ws://mbsd.ipviking.com:443");ws.onmessage=function(t){var e=JSON.parse(t.data),r={lat:+e.latitude,lon:+e.longitude},a={lat:+e.latitude2,lon:+e.longitude2},n=worldmap.name[e.countrycode]||"Unknow";origin[n]?origin[n]++:origin[n]=1;var i=worldmap.name[e.countrycode2]||"Unknow";targets[i]?targets[i]++:targets[i]=1,realtime.push({Time:(new Date).toLocaleString(),Origin:n,Targets:i,Type:services[e.dport]||"Unknow"}),realtime.length>8&&realtime.shift(),React.render(React.createElement(Info,{className:"info",origin:origin,targets:targets,realtime:realtime}),list),map.trigger(r,a)},ws.onerror=function(t){alert("WebSocket发生异常，请重新刷新网页。"),console.log(t)};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hcC5qcyIsImluZm8uanN4IiwiYm9vdC5qcyJdLCJuYW1lcyI6WyJfaW5oZXJpdHMiLCJzdWJDbGFzcyIsInN1cGVyQ2xhc3MiLCJUeXBlRXJyb3IiLCJwcm90b3R5cGUiLCJPYmplY3QiLCJjcmVhdGUiLCJjb25zdHJ1Y3RvciIsInZhbHVlIiwiZW51bWVyYWJsZSIsIndyaXRhYmxlIiwiY29uZmlndXJhYmxlIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiX2dldCIsIl94IiwiX3gyIiwiX3gzIiwiX2FnYWluIiwib2JqZWN0IiwicHJvcGVydHkiLCJyZWNlaXZlciIsImRlc2MiLCJwYXJlbnQiLCJnZXR0ZXIiLCJ1bmRlZmluZWQiLCJGdW5jdGlvbiIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImdldCIsImNhbGwiLCJnZXRQcm90b3R5cGVPZiIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImkiLCJsZW5ndGgiLCJkZXNjcmlwdG9yIiwiZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJNYXAiLCJvcHRpb24iLCJfdGhpcyIsInRoaXMiLCJXSURUSCIsIndpZHRoIiwiSEVJR0hUIiwic2NhbGUiLCJjYW52YXMiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjdHgiLCJnZXRDb250ZXh0IiwiaGVpZ2h0IiwiY29udGFpbmVyIiwiYXBwZW5kQ2hpbGQiLCJkcmF3U3ZnIiwibWFwRGF0ZSIsImdldEltYWdlRGF0YSIsImNvdW50IiwicGFydGljbGVzIiwicGFydGljbGUiLCJuZXh0SW5kZXgiLCJ4IiwieSIsInIiLCJvIiwiYyIsInh2IiwieXYiLCJydiIsIm92IiwiaW5kZXgiLCJzdGFydCIsImVuZCIsImdldFhZIiwidGltZXN0YW1wIiwiRGF0ZSIsInN0YXJ0Q29sb3IiLCJlbmRDb2xvciIsInBhcnRpY2xlQ29sb3IiLCJpbmZvIiwiZHVyYXRpb24iLCJyYWRpdXMiLCJwYXJzZUludCIsIk1hdGgiLCJyYW5kb20iLCJkcmF3IiwiY2xlYXJSZWN0IiwicHV0SW1hZ2VEYXRhIiwibm93IiwiY2xlYXIiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uIiwiX2RpZEl0ZXJhdG9yRXJyb3IiLCJfaXRlcmF0b3JFcnJvciIsIl9zdGVwIiwiX2l0ZXJhdG9yIiwia2V5cyIsIlN5bWJvbCIsIml0ZXJhdG9yIiwibmV4dCIsImRvbmUiLCJwIiwiYmVnaW5QYXRoIiwiYXJjIiwiUEkiLCJnbG9iYWxBbHBoYSIsImZpbGxTdHlsZSIsImZpbGwiLCJlcnIiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiIsIl9kaWRJdGVyYXRvckVycm9yMiIsIl9pdGVyYXRvckVycm9yMiIsIl9zdGVwMiIsIl9pdGVyYXRvcjIiLCJ0aW1lIiwiZWFzZU91dFF1aW50Iiwib2Zmc2V0eCIsIm9mZnNldHkiLCJvcGFjaXR5Iiwic3Ryb2tlU3R5bGUiLCJsaW5lV2lkdGgiLCJzdHJva2UiLCJudW1QYXJ0aWNsZXMiLCJzcXJ0IiwibnVtUGFydGljbGVzSW50IiwiY2VpbCIsIm51bVBhcnRpY2xlc0RpZiIsImoiLCJ3aW5kb3ciLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJiaW5kIiwibG9uIiwibGF0IiwidCIsImIiLCJkIiwic2luIiwiQXR0YWNrTGlzdCIsIl9SZWFjdCRDb21wb25lbnQiLCJhcHBseSIsImFyZ3VtZW50cyIsImNvdW50cnkiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyIsIl9kaWRJdGVyYXRvckVycm9yMyIsIl9pdGVyYXRvckVycm9yMyIsIl9zdGVwMyIsIl9pdGVyYXRvcjMiLCJsaXN0IiwicHVzaCIsIlJlYWN0IiwiY2xhc3NOYW1lIiwic29ydCIsImEiLCJzbGljZSIsIm1hcCIsIml0ZW0iLCJDb21wb25lbnQiLCJSZWFsVGltZUxpc3QiLCJfUmVhY3QkQ29tcG9uZW50MiIsInJlYWx0aW1lIiwiVGltZSIsIk9yaWdpbiIsIlRhcmdldHMiLCJUeXBlIiwiSW5mbyIsIl9SZWFjdCRDb21wb25lbnQzIiwib3JpZ2luIiwidGFyZ2V0cyIsInF1ZXJ5U2VsZWN0b3IiLCJzY3JlZW4iLCJ3b3JsZG1hcCIsIndzIiwiV2ViU29ja2V0Iiwib25tZXNzYWdlIiwiZSIsImRhdGEiLCJKU09OIiwicGFyc2UiLCJvcmlDb3VudHJ5IiwibmFtZSIsInRhckNvdW50cnkiLCJ0b0xvY2FsZVN0cmluZyIsInNlcnZpY2VzIiwic2hpZnQiLCJyZW5kZXIiLCJ0cmlnZ2VyIiwib25lcnJvciIsImFsZXJ0IiwiY29uc29sZSIsImxvZyJdLCJtYXBwaW5ncyI6IkFBQUEsWUFNQSxTQUFTQSxXQUFVQyxFQUFVQyxHQUFjLEdBQTBCLGtCQUFmQSxJQUE0QyxPQUFmQSxFQUF1QixLQUFNLElBQUlDLFdBQVUsaUVBQW9FRCxHQUFlRCxHQUFTRyxVQUFZQyxPQUFPQyxPQUFPSixHQUFjQSxFQUFXRSxXQUFhRyxhQUFlQyxNQUFPUCxFQUFVUSxZQUFZLEVBQU9DLFVBQVUsRUFBTUMsY0FBYyxLQUFlVCxJQUFZRyxPQUFPTyxlQUFpQlAsT0FBT08sZUFBZVgsRUFBVUMsR0FBY0QsRUFBU1ksVUFBWVgsR0FFamUsUUFBU1ksaUJBQWdCQyxFQUFVQyxHQUFlLEtBQU1ELFlBQW9CQyxJQUFnQixLQUFNLElBQUliLFdBQVUscUNBTmhILEdBQUljLE1BQU8sU0FBYUMsRUFBSUMsRUFBS0MsR0FBcUMsSUFBOUIsR0FBSUMsSUFBUyxFQUF3QkEsR0FBUSxDQUFFLEdBQUlDLEdBQVNKLEVBQUlLLEVBQVdKLEVBQUtLLEVBQVdKLENBQUtLLEdBQU9DLEVBQVNDLEVBQVNDLE9BQVdQLEdBQVMsRUFBc0IsT0FBWEMsSUFBaUJBLEVBQVNPLFNBQVN6QixVQUFXLElBQUlxQixHQUFPcEIsT0FBT3lCLHlCQUF5QlIsRUFBUUMsRUFBVyxJQUFhSyxTQUFUSCxFQUFKLENBQWlOLEdBQUksU0FBV0EsR0FBUSxNQUFPQSxH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QWtHLEdBQUFlLFFBQUEsU0FBQVosR0FDQWEsTUFBQSwwQkFDQUMsUUFBQUMsSUFBQWYiLCJmaWxlIjoibWFwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xyXG5jbGFzcyBNYXAge1xyXG4gICAgY29uc3RydWN0b3Iob3B0aW9uKSB7XHJcbiAgICAgICAgdGhpcy5XSURUSCA9IG9wdGlvbi53aWR0aDtcclxuICAgICAgICB0aGlzLkhFSUdIVCA9IG9wdGlvbi53aWR0aCAqIDAuNDtcclxuICAgICAgICB0aGlzLnNjYWxlID0gdGhpcy5XSURUSCAvIDEwMDA7XHJcblxyXG4gICAgICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XHJcbiAgICAgICAgdGhpcy5jdHggPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG4gICAgICAgIHRoaXMuY2FudmFzLndpZHRoID0gdGhpcy5XSURUSDtcclxuICAgICAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSB0aGlzLkhFSUdIVDtcclxuICAgICAgICBvcHRpb24uY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuY2FudmFzKTtcclxuXHJcbiAgICAgICAgdGhpcy5jdHguZHJhd1N2Zygnd29ybGQuc3ZnJywgMCwgMCwgdGhpcy5XSURUSCwgdGhpcy5IRUlHSFQpO1xyXG4gICAgICAgIHRoaXMubWFwRGF0ZSA9IHRoaXMuY3R4LmdldEltYWdlRGF0YSgwLCAwLCB0aGlzLldJRFRILHRoaXMuSEVJR0hUKTtcclxuXHJcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSB7fTtcclxuICAgICAgICB0aGlzLmNvdW50ID0gMDsvLyBxdWV1ZeaAu+aVsFxyXG5cclxuICAgICAgICB0aGlzLnBhcnRpY2xlcyA9IHt9XHJcbiAgICAgICAgdGhpcy5wYXJ0aWNsZSA9ICgoKSA9PiB7XHJcbiAgICAgICAgICBsZXQgbmV4dEluZGV4ID0gMDtcclxuICAgICAgICAgIHJldHVybiAoeCx5LHIsbyxjLHh2LHl2LHJ2LG92KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucGFydGljbGVzWysrbmV4dEluZGV4XSA9IHtcclxuICAgICAgICAgICAgICBpbmRleDogbmV4dEluZGV4LFxyXG4gICAgICAgICAgICAgIHg6IHgsXHJcbiAgICAgICAgICAgICAgeTogeSxcclxuICAgICAgICAgICAgICByOiByLFxyXG4gICAgICAgICAgICAgIG86IG8sXHJcbiAgICAgICAgICAgICAgYzogYyxcclxuICAgICAgICAgICAgICB4djogeHYsXHJcbiAgICAgICAgICAgICAgeXY6IHl2LFxyXG4gICAgICAgICAgICAgIHJ2OiBydixcclxuICAgICAgICAgICAgICBvdjogb3ZcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfSkoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOinpuWPkeWKqOeUu1xyXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSBzdGFydFxyXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSBlbmRcclxuICAgICAqIEByZXR1cm4ge251bGx9XHJcbiAgICAgKi9cclxuICAgIHRyaWdnZXIoc3RhcnQsIGVuZCkge1xyXG4gICAgICAgIHN0YXJ0ID0gdGhpcy5nZXRYWShzdGFydCk7XHJcbiAgICAgICAgZW5kID0gdGhpcy5nZXRYWShlbmQpO1xyXG4gICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9ICtuZXcgRGF0ZSxcclxuICAgICAgICAgICAgICBzdGFydENvbG9yID0gJyMyMWIzODQnLFxyXG4gICAgICAgICAgICAgIGVuZENvbG9yID0gJyNlMzI1MjgnLFxyXG4gICAgICAgICAgICAgIHBhcnRpY2xlQ29sb3IgPSAnI0Y4QkQxOSc7XHJcbiAgICAgICAgaWYodGhpcy5jb250YWluZXJbdGltZXN0YW1wXSkgcmV0dXJuO1xyXG4gICAgICAgIGxldCBpbmZvID0ge1xyXG4gICAgICAgICAgICBzdGFydDogc3RhcnQsXHJcbiAgICAgICAgICAgIGVuZDogZW5kLFxyXG4gICAgICAgICAgICBzdGFydENvbG9yOiBzdGFydENvbG9yLFxyXG4gICAgICAgICAgICBlbmRDb2xvcjogZW5kQ29sb3IsXHJcbiAgICAgICAgICAgIHBhcnRpY2xlQ29sb3I6IHBhcnRpY2xlQ29sb3IsXHJcbiAgICAgICAgICAgIGR1cmF0aW9uOiAxMDAwLFxyXG4gICAgICAgICAgICByYWRpdXM6IDcwICsgcGFyc2VJbnQoTWF0aC5yYW5kb20oKSAqIDIwKSxcclxuICAgICAgICAgICAgeHY6IChzdGFydC54IC0gZW5kLngpICogMC4wMixcclxuICAgICAgICAgICAgeXY6IChzdGFydC55IC0gZW5kLnkpICogMC4wMlxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNvbnRhaW5lclt0aW1lc3RhbXBdID0gaW5mbztcclxuICAgICAgICBpZighKHRoaXMuY291bnQpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5kcmF3KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyKCkge1xyXG4gICAgICAgIHRoaXMuY3R4LmNsZWFyUmVjdCgwLDAsdGhpcy5XSURUSCx0aGlzLkhFSUdIVCk7XHJcbiAgICAgICAgdGhpcy5jdHgucHV0SW1hZ2VEYXRhKHRoaXMubWFwRGF0ZSwgMCwgMCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmuLLmn5NcclxuICAgICAqIEByZXR1cm4ge251bGx9XHJcbiAgICAgKi9cclxuICAgIGRyYXcoKSB7XHJcbiAgICAgICAgY29uc3Qgbm93ID0gK25ldyBEYXRlO1xyXG4gICAgICAgIHRoaXMuY2xlYXIoKTtcclxuXHJcbiAgICAgICAgLy8gcGFydGljbGVzXHJcbiAgICAgICAgZm9yKGxldCBrZXkgb2YgT2JqZWN0LmtleXModGhpcy5wYXJ0aWNsZXMpKSB7XHJcbiAgICAgICAgICAgIGxldCBwID0gdGhpcy5wYXJ0aWNsZXNba2V5XTtcclxuICAgICAgICAgICAgdGhpcy5jdHguYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY3R4LmFyYyhwLngsIHAueSwgcC5yLCAwLCBNYXRoLlBJKjIpO1xyXG4gICAgICAgICAgICB0aGlzLmN0eC5nbG9iYWxBbHBoYSA9IHAubztcclxuICAgICAgICAgICAgdGhpcy5jdHguZmlsbFN0eWxlID0gcC5jO1xyXG4gICAgICAgICAgICB0aGlzLmN0eC5maWxsKCk7XHJcbiAgICAgICAgICAgIHAueCArPSBwLnh2O1xyXG4gICAgICAgICAgICBwLnkgKz0gcC55djtcclxuICAgICAgICAgICAgcC5yICs9IHAucnY7XHJcbiAgICAgICAgICAgIHAubyArPSBwLm92O1xyXG4gICAgICAgICAgICBpZihwLnIgPCAwIHx8IHAubyA8IDApIGRlbGV0ZSB0aGlzLnBhcnRpY2xlc1twLmluZGV4XTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGZpcmViYWxscyBhbmQgY2lyY2xlXHJcbiAgICAgICAgZm9yKGxldCBrZXkgb2YgT2JqZWN0LmtleXModGhpcy5jb250YWluZXIpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRpbWUgPSBub3cgLSBrZXk7XHJcbiAgICAgICAgICAgIGNvbnN0IGluZm8gPSB0aGlzLmNvbnRhaW5lcltrZXldO1xyXG4gICAgICAgICAgICBpZih0aW1lIDwgaW5mby5kdXJhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuZWFzZU91dFF1aW50KHRpbWUsIDAsIGluZm8ucmFkaXVzLCBpbmZvLmR1cmF0aW9uKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG9mZnNldHggPSBpbmZvLnN0YXJ0LnggKyB0aW1lIC8gaW5mby5kdXJhdGlvbiAqIChpbmZvLmVuZC54IC0gaW5mby5zdGFydC54KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG9mZnNldHkgPSBpbmZvLnN0YXJ0LnkgKyB0aW1lIC8gaW5mby5kdXJhdGlvbiAqIChpbmZvLmVuZC55IC0gaW5mby5zdGFydC55KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG9wYWNpdHkgPSB0aGlzLmVhc2VPdXRRdWludCh0aW1lLCAxLCAtMSwgaW5mby5kdXJhdGlvbik7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gY2lyY2xlXHJcbiAgICAgICAgICAgICAgICB0aGlzLmN0eC5nbG9iYWxBbHBoYSA9IG9wYWNpdHk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN0eC5zdHJva2VTdHlsZSA9IGluZm8uc3RhcnRDb2xvcjtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3R4LmxpbmVXaWR0aCA9IDU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3R4LmFyYyhpbmZvLnN0YXJ0LngsIGluZm8uc3RhcnQueSwgciwgMCwgMipNYXRoLlBJKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3R4LnN0cm9rZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBudW1QYXJ0aWNsZXMgPSBNYXRoLnNxcnQoaW5mby54dippbmZvLnh2ICsgaW5mby55dippbmZvLnl2KSAvIDU7XHJcbiAgICAgICAgICAgICAgICBpZihudW1QYXJ0aWNsZXMgPCAxKSBudW1QYXJ0aWNsZXMgPSAxO1xyXG4gICAgICAgICAgICAgICAgbGV0IG51bVBhcnRpY2xlc0ludCA9IE1hdGguY2VpbChudW1QYXJ0aWNsZXMpLFxyXG4gICAgICAgICAgICAgICAgICAgIG51bVBhcnRpY2xlc0RpZiA9IG51bVBhcnRpY2xlcyAvIG51bVBhcnRpY2xlc0ludDtcclxuICAgICAgICAgICAgICAgIGZvcihsZXQgaiA9IDA7IGogPCBudW1QYXJ0aWNsZXNJbnQ7IGorKykge1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLnBhcnRpY2xlKFxyXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldHgtaW5mby54dipqL251bVBhcnRpY2xlc0ludCxcclxuICAgICAgICAgICAgICAgICAgICBvZmZzZXR5LWluZm8ueXYqai9udW1QYXJ0aWNsZXNJbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgNyxcclxuICAgICAgICAgICAgICAgICAgICBudW1QYXJ0aWNsZXNEaWYsXHJcbiAgICAgICAgICAgICAgICAgICAgaW5mby5wYXJ0aWNsZUNvbG9yLFxyXG4gICAgICAgICAgICAgICAgICAgIE1hdGgucmFuZG9tKCkqMC42LTAuMyxcclxuICAgICAgICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpKjAuNi0wLjMsXHJcbiAgICAgICAgICAgICAgICAgICAgLTAuMyxcclxuICAgICAgICAgICAgICAgICAgICAtMC4wNSpudW1QYXJ0aWNsZXNEaWZcclxuICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIGlmKHRpbWUgPCBpbmZvLmR1cmF0aW9uICogMikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuZWFzZU91dFF1aW50KHRpbWUgLSBpbmZvLmR1cmF0aW9uLCAwLCBpbmZvLnJhZGl1cywgaW5mby5kdXJhdGlvbik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvcGFjaXR5ID0gdGhpcy5lYXNlT3V0UXVpbnQodGltZSAtIGluZm8uZHVyYXRpb24sIDEsIC0xLCBpbmZvLmR1cmF0aW9uKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBjaXJjbGVcclxuICAgICAgICAgICAgICAgIHRoaXMuY3R4Lmdsb2JhbEFscGhhID0gb3BhY2l0eTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3R4LnN0cm9rZVN0eWxlID0gaW5mby5lbmRDb2xvcjtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3R4LmxpbmVXaWR0aCA9IDU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3R4LmFyYyhpbmZvLmVuZC54LCBpbmZvLmVuZC55LCByLCAwLCAyKk1hdGguUEkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdHguc3Ryb2tlKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5jb250YWluZXJba2V5XTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY291bnQtLTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYodGhpcy5jb3VudCkge1xyXG4gICAgICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMuZHJhdy5iaW5kKHRoaXMpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDnu4/nuqzluqYgdG8gWFlcclxuICAgICAqIEBwYXJhbSAge09iamVjdH0gb3B0aW9uXHJcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9XHJcbiAgICAgKi9cclxuICAgIGdldFhZIChvcHRpb24pIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB4OiAob3B0aW9uLmxvbiAqIDIuNjkzOCArIDQ2NS40KSAqIHRoaXMuc2NhbGUsXHJcbiAgICAgICAgICAgIHk6IChvcHRpb24ubGF0ICogLTIuNjkzOCArIDIyNy4wNjYpICogdGhpcy5zY2FsZVxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog57yT5Yqo5Ye95pWwXHJcbiAgICAgKiBAcGFyYW0gIHtOdW1iZXJ9IHQg5YeG56Gu5pe26Ze0XHJcbiAgICAgKiBAcGFyYW0gIHtOdW1iZXJ9IGIg5byA5aeL5YC8XHJcbiAgICAgKiBAcGFyYW0gIHtOdW1iZXJ9IGMg5pS55Y+Y5YC8XHJcbiAgICAgKiBAcGFyYW0gIHtOdW1iZXJ9IGQg5oC75pe26Ze0XHJcbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9ICAgdmFsdWVcclxuICAgICAqL1xyXG4gICAgIGVhc2VPdXRRdWludCAodCwgYiwgYywgZCkge1xyXG4gXHRcdHJldHVybiBjICogTWF0aC5zaW4odC9kICogKE1hdGguUEkvMikpICsgYjtcclxuIFx0fVxyXG59XHJcbiIsImNsYXNzIEF0dGFja0xpc3QgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIGxldCBjb3VudHJ5ID0gW107XHJcbiAgICAgICAgZm9yKGxldCBrZXkgb2YgT2JqZWN0LmtleXModGhpcy5wcm9wcy5saXN0KSkge1xyXG4gICAgICAgICAgICBjb3VudHJ5LnB1c2goe1xyXG4gICAgICAgICAgICAgICAgY291bnRyeToga2V5LFxyXG4gICAgICAgICAgICAgICAgY291bnQ6IHRoaXMucHJvcHMubGlzdFtrZXldXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPHRhYmxlIGNsYXNzTmFtZT17IHRoaXMucHJvcHMuY2xhc3NOYW1lIH0+XHJcbiAgICAgICAgICAgICAgICA8dHI+XHJcbiAgICAgICAgICAgICAgICAgIDx0aD57IHRoaXMucHJvcHMuY2xhc3NOYW1lID09ICdhdHRhY2tvcmlnaW4nID8gJ09yaWdpbicgOiAnVGFyZ2V0cycgfTwvdGg+XHJcbiAgICAgICAgICAgICAgICAgIDx0aD5Db3VudDwvdGg+XHJcbiAgICAgICAgICAgICAgICA8L3RyPlxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvdW50cnlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnNvcnQoKGEsIGIpID0+IGIuY291bnQgLSBhLmNvdW50KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2xpY2UoMCwgOSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLm1hcCgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+eyBpdGVtLmNvdW50cnkgfTwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+eyBpdGVtLmNvdW50IH08L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICA8L3RhYmxlPlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmNsYXNzIFJlYWxUaW1lTGlzdCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcbiAgICByZW5kZXIgKCkge1xyXG5cclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8dGFibGUgY2xhc3NOYW1lPXsgdGhpcy5wcm9wcy5jbGFzc05hbWUgfT5cclxuICAgICAgICAgICAgICAgIDx0cj5cclxuICAgICAgICAgICAgICAgICAgPHRoPlRpbWU8L3RoPlxyXG4gICAgICAgICAgICAgICAgICA8dGg+T3JpZ2luPC90aD5cclxuICAgICAgICAgICAgICAgICAgPHRoPlRhcmdldHM8L3RoPlxyXG4gICAgICAgICAgICAgICAgICA8dGg+VHlwZTwvdGg+XHJcbiAgICAgICAgICAgICAgICA8L3RyPlxyXG4gICAgICAgICAgICAgICAgeyB0aGlzLnByb3BzLnJlYWx0aW1lLm1hcCgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDx0cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgd2lkdGg9XCIyMDBcIj57IGl0ZW0uVGltZSB9PC90ZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+eyBpdGVtLk9yaWdpbiB9PC90ZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgd2lkdGg9XCIyMDBcIj57IGl0ZW0uVGFyZ2V0cyB9PC90ZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+eyBpdGVtLlR5cGUgfTwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH0pIH1cclxuICAgICAgICAgICAgPC90YWJsZT5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcblxyXG5jbGFzcyBJbmZvIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImluZm9cIj5cclxuICAgICAgICAgICAgICAgIDxBdHRhY2tMaXN0IGxpc3Q9eyB0aGlzLnByb3BzLm9yaWdpbiB9IGNsYXNzTmFtZT1cImF0dGFja29yaWdpblwiIC8+XHJcbiAgICAgICAgICAgICAgICA8QXR0YWNrTGlzdCBsaXN0PXsgdGhpcy5wcm9wcy50YXJnZXRzIH0gY2xhc3NOYW1lPVwiYXR0YWNrdGFyZ2V0c1wiIC8+XHJcbiAgICAgICAgICAgICAgICA8UmVhbFRpbWVMaXN0IHJlYWx0aW1lPXsgdGhpcy5wcm9wcy5yZWFsdGltZSB9IGNsYXNzTmFtZT1cInJlYWx0aW1lXCIgLz5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG4iLCIndXNlIHN0cmljdCc7XHJcblxyXG5sZXQgbWFwID0gbmV3IE1hcCh7XHJcbiAgICBjb250YWluZXI6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tYXAnKSxcclxuICAgIHdpZHRoOiBzY3JlZW4ud2lkdGgsXHJcbiAgICB3b3JsZG1hcDogd29ybGRtYXBcclxufSk7XHJcblxyXG5sZXQgbGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saXN0Jyk7XHJcblxyXG5sZXQgb3JpZ2luID0ge30sXHJcbiAgICB0YXJnZXRzID0ge30sXHJcbiAgICByZWFsdGltZSA9IFtdO1xyXG5cclxuY29uc3Qgd3MgPSBuZXcgV2ViU29ja2V0KCd3czovL21ic2QuaXB2aWtpbmcuY29tOjQ0MycpO1xyXG53cy5vbm1lc3NhZ2UgPSBmdW5jdGlvbihlKSB7XHJcbiAgICBsZXQgZGF0YSA9IEpTT04ucGFyc2UoZS5kYXRhKTtcclxuICAgIGNvbnN0IHN0YXJ0ID0ge1xyXG4gICAgICAgIGxhdDogK2RhdGFbJ2xhdGl0dWRlJ10sXHJcbiAgICAgICAgbG9uOiArZGF0YVsnbG9uZ2l0dWRlJ11cclxuICAgIH07XHJcbiAgICBjb25zdCBlbmQgPSB7XHJcbiAgICAgICAgbGF0OiArZGF0YVsnbGF0aXR1ZGUyJ10sXHJcbiAgICAgICAgbG9uOiArZGF0YVsnbG9uZ2l0dWRlMiddXHJcbiAgICB9O1xyXG4gICAgY29uc3Qgb3JpQ291bnRyeSA9IHdvcmxkbWFwLm5hbWVbZGF0YVsnY291bnRyeWNvZGUnXV0gfHwgJ1Vua25vdyc7XHJcbiAgICBvcmlnaW5bb3JpQ291bnRyeV0gPyBvcmlnaW5bb3JpQ291bnRyeV0rKyA6IG9yaWdpbltvcmlDb3VudHJ5XSA9IDE7XHJcbiAgICBjb25zdCB0YXJDb3VudHJ5ID0gd29ybGRtYXAubmFtZVtkYXRhWydjb3VudHJ5Y29kZTInXV0gfHwgJ1Vua25vdyc7XHJcbiAgICB0YXJnZXRzW3RhckNvdW50cnldID8gdGFyZ2V0c1t0YXJDb3VudHJ5XSsrIDogdGFyZ2V0c1t0YXJDb3VudHJ5XSA9IDE7XHJcblxyXG4gICAgcmVhbHRpbWUucHVzaCh7XHJcbiAgICAgICAgVGltZTogbmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygpLFxyXG4gICAgICAgIE9yaWdpbjogb3JpQ291bnRyeSxcclxuICAgICAgICBUYXJnZXRzOiB0YXJDb3VudHJ5LFxyXG4gICAgICAgIFR5cGU6IHNlcnZpY2VzW2RhdGFbJ2Rwb3J0J11dIHx8ICdVbmtub3cnXHJcbiAgICB9KTtcclxuXHJcbiAgICBpZihyZWFsdGltZS5sZW5ndGggPiA4KSByZWFsdGltZS5zaGlmdCgpO1xyXG5cclxuICAgIFJlYWN0LnJlbmRlcihcclxuICAgICAgICA8SW5mbyBjbGFzc05hbWU9XCJpbmZvXCIgb3JpZ2luPXsgb3JpZ2luIH0gdGFyZ2V0cz17IHRhcmdldHMgfSByZWFsdGltZT17IHJlYWx0aW1lIH0gLz4sXHJcbiAgICAgICAgbGlzdCk7XHJcblxyXG4gICAgbWFwLnRyaWdnZXIoc3RhcnQsIGVuZCk7XHJcbn07XHJcblxyXG53cy5vbmVycm9yID0gZnVuY3Rpb24gKGUpIHtcclxuICAgIGFsZXJ0KCdXZWJTb2NrZXTlj5HnlJ/lvILluLjvvIzor7fph43mlrDliLfmlrDnvZHpobXjgIInKTtcclxuICAgIGNvbnNvbGUubG9nKGUpO1xyXG59O1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=