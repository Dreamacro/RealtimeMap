"use strict";function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _get=function(t,e,r){for(var a=!0;a;){var n=t,i=e,o=r;s=l=c=void 0,a=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,i);if(void 0!==s){if("value"in s)return s.value;var c=s.get;return void 0===c?void 0:c.call(o)}var l=Object.getPrototypeOf(n);if(null===l)return void 0;t=l,e=i,r=o,a=!0}},_createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),Map=function(){function t(e){_classCallCheck(this,t),this.scale=e.width/1e3,this.svg=this.createSVGElement("svg",{width:e.width,height:e.height}),e.container.appendChild(this.svg);var r=!0,a=!1,n=void 0;try{for(var i,o=Object.keys(e.worldmap.shapes)[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var s=i.value,c=this.createSVGElement("path",{stroke:"#ccc6ae",fill:"#000",d:e.worldmap.shapes[s],transform:"scale("+this.scale+")"});this.svg.appendChild(c)}}catch(l){a=!0,n=l}finally{try{!r&&o["return"]&&o["return"]()}finally{if(a)throw n}}this.container={},this.count=0}return _createClass(t,[{key:"createSVGElement",value:function(t,e){var r=document.createElementNS("http://www.w3.org/2000/svg",t);return this.setAttr(r,e)}},{key:"setAttr",value:function(t,e){var r=!0,a=!1,n=void 0;try{for(var i,o=Object.keys(e)[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var s=i.value;t.setAttribute(s,e[s])}}catch(c){a=!0,n=c}finally{try{!r&&o["return"]&&o["return"]()}finally{if(a)throw n}}return t}},{key:"trigger",value:function(t,e){t=this.getXY(t),e=this.getXY(e);var r=+new Date,a="#21b384",n="#e32528";if(!this.container[r]){var i={"stroke-width":2,"fill:":"none",r:0,opacity:1},o=this.createSVGElement("circle",i),s=this.createSVGElement("circle",i);i={stroke:n,"stroke-width":5,opacity:.5,"stroke-linecap":"round",d:"M"+t.cx+" "+t.cy+" L"+e.cx+" "+e.cy};var c=this.createSVGElement("path",i),l=c.getTotalLength();this.setAttr(c,{"stroke-dasharray":l,"stroke-dashoffset":l}),this.setAttr(o,{stroke:a,cx:t.cx,cy:t.cy}),this.setAttr(s,{stroke:n,cx:e.cx,cy:e.cy}),this.svg.appendChild(o),this.svg.appendChild(s),this.svg.appendChild(c);var u={startCircle:o,endCircle:s,path:c,totalLength:l,duration:1e3,radius:70+parseInt(20*Math.random()),stage:0};this.container[r]=u,this.count++||this.draw()}}},{key:"draw",value:function(){var t=this,e=+new Date,r=!0,a=!1,n=void 0;try{for(var i,o=function(){var r=i.value,a=e-r,n=t.container[r];if(a<n.duration){var o=t.easeOutQuint(a,0,n.radius,n.duration),s=t.easeOutQuint(a,n.totalLength,-2*n.totalLength,n.duration),c=t.easeOutQuint(a,1,-1,n.duration);t.setAttr(n.startCircle,{r:o,opacity:c}),t.setAttr(n.path,{"stroke-dashoffset":s})}else if(a<2*n.duration){0===n.stage&&(setTimeout(function(){t.svg.removeChild(n.startCircle),t.svg.removeChild(n.path)},0),n.stage=1);var o=t.easeOutQuint(a-n.duration,0,n.radius,n.duration),c=t.easeOutQuint(a-n.duration,1,-1,n.duration);t.setAttr(n.endCircle,{r:o,opacity:c})}else setTimeout(function(){return t.svg.removeChild(n.endCircle)},0),delete t.container[r],t.count--},s=Object.keys(this.container)[Symbol.iterator]();!(r=(i=s.next()).done);r=!0)o()}catch(c){a=!0,n=c}finally{try{!r&&s["return"]&&s["return"]()}finally{if(a)throw n}}this.count&&window.requestAnimationFrame(this.draw.bind(this))}},{key:"getXY",value:function(t){return{cx:(2.6938*t.lon+465.4)*this.scale,cy:(-2.6938*t.lat+227.066)*this.scale}}},{key:"easeOutQuint",value:function(t,e,r,a){return r*Math.sin(t/a*(Math.PI/2))+e}}]),t}(),AttackList=function(t){function e(){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return _inherits(e,t),_createClass(e,[{key:"render",value:function(){var t=[],e=!0,r=!1,a=void 0;try{for(var n,i=Object.keys(this.props.list)[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){var o=n.value;t.push({country:o,count:this.props.list[o]})}}catch(s){r=!0,a=s}finally{try{!e&&i["return"]&&i["return"]()}finally{if(r)throw a}}return React.createElement("table",{className:this.props.className},React.createElement("tr",null,React.createElement("th",null,"attackorigin"==this.props.className?"Origin":"Targets"),React.createElement("th",null,"Count")),t.sort(function(t,e){return e.count-t.count}).slice(0,9).map(function(t){return React.createElement("tr",null,React.createElement("td",null,t.country),React.createElement("td",null,t.count))}))}}]),e}(React.Component),RealTimeList=function(t){function e(){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return _inherits(e,t),_createClass(e,[{key:"render",value:function(){return React.createElement("table",{className:this.props.className},React.createElement("tr",null,React.createElement("th",null,"Time"),React.createElement("th",null,"Origin"),React.createElement("th",null,"Targets"),React.createElement("th",null,"Type")),this.props.realtime.map(function(t){return React.createElement("tr",null,React.createElement("td",{width:"200"},t.Time),React.createElement("td",null,t.Origin),React.createElement("td",{width:"200"},t.Targets),React.createElement("td",null,t.Type))}))}}]),e}(React.Component),Info=function(t){function e(){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return _inherits(e,t),_createClass(e,[{key:"render",value:function(){return React.createElement("div",{className:"info"},React.createElement(AttackList,{list:this.props.origin,className:"attackorigin"}),React.createElement(AttackList,{list:this.props.targets,className:"attacktargets"}),React.createElement(RealTimeList,{realtime:this.props.realtime,className:"realtime"}))}}]),e}(React.Component),map=new Map({container:document.querySelector(".map"),width:screen.width,height:.4*screen.width,worldmap:worldmap}),list=document.querySelector(".list"),origin={},targets={},realtime=[],ws=new WebSocket("ws://mbsd.ipviking.com:443");ws.onmessage=function(t){var e=JSON.parse(t.data),r={lat:+e.latitude,lon:+e.longitude},a={lat:+e.latitude2,lon:+e.longitude2},n=worldmap.name[e.countrycode]||"Unknow";origin[n]?origin[n]++:origin[n]=1;var i=worldmap.name[e.countrycode2]||"Unknow";targets[i]?targets[i]++:targets[i]=1,realtime.push({Time:(new Date).toLocaleString(),Origin:n,Targets:i,Type:services[e.dport]||"Unknow"}),realtime.length>8&&realtime.shift(),React.render(React.createElement(Info,{className:"info",origin:origin,targets:targets,realtime:realtime}),list),map.trigger(r,a)};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hcC5qcyIsImluZm8uanN4IiwiYm9vdC5qcyJdLCJuYW1lcyI6WyJfaW5oZXJpdHMiLCJzdWJDbGFzcyIsInN1cGVyQ2xhc3MiLCJUeXBlRXJyb3IiLCJwcm90b3R5cGUiLCJPYmplY3QiLCJjcmVhdGUiLCJjb25zdHJ1Y3RvciIsInZhbHVlIiwiZW51bWVyYWJsZSIsIndyaXRhYmxlIiwiY29uZmlndXJhYmxlIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiX2dldCIsIl94IiwiX3gyIiwiX3gzIiwiX2FnYWluIiwib2JqZWN0IiwicHJvcGVydHkiLCJyZWNlaXZlciIsImRlc2MiLCJwYXJlbnQiLCJnZXR0ZXIiLCJ1bmRlZmluZWQiLCJGdW5jdGlvbiIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImdldCIsImNhbGwiLCJnZXRQcm90b3R5cGVPZiIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImkiLCJsZW5ndGgiLCJkZXNjcmlwdG9yIiwiZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJNYXAiLCJvcHRpb24iLCJ0aGlzIiwic2NhbGUiLCJ3aWR0aCIsInN2ZyIsImNyZWF0ZVNWR0VsZW1lbnQiLCJoZWlnaHQiLCJjb250YWluZXIiLCJhcHBlbmRDaGlsZCIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24iLCJfZGlkSXRlcmF0b3JFcnJvciIsIl9pdGVyYXRvckVycm9yIiwiX3N0ZXAiLCJfaXRlcmF0b3IiLCJrZXlzIiwid29ybGRtYXAiLCJzaGFwZXMiLCJTeW1ib2wiLCJpdGVyYXRvciIsIm5leHQiLCJkb25lIiwiY291bnRyeSIsInBhdGgiLCJzdHJva2UiLCJmaWxsIiwiZCIsInRyYW5zZm9ybSIsImVyciIsImNvdW50IiwibmFtZSIsImF0dHIiLCJlbGUiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnROUyIsInNldEF0dHIiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiIsIl9kaWRJdGVyYXRvckVycm9yMiIsIl9pdGVyYXRvckVycm9yMiIsIl9zdGVwMiIsIl9pdGVyYXRvcjIiLCJzZXRBdHRyaWJ1dGUiLCJzdGFydCIsImVuZCIsImdldFhZIiwidGltZXN0YW1wIiwiRGF0ZSIsInN0YXJ0Q29sb3IiLCJlbmRDb2xvciIsInN0cm9rZS13aWR0aCIsImZpbGw6IiwiciIsIm9wYWNpdHkiLCJzdGFydENpcmNsZSIsImVuZENpcmNsZSIsInN0cm9rZS1saW5lY2FwIiwiY3giLCJjeSIsImxpbmUiLCJ0b3RhbExlbmd0aCIsImdldFRvdGFsTGVuZ3RoIiwic3Ryb2tlLWRhc2hhcnJheSIsInN0cm9rZS1kYXNob2Zmc2V0IiwiaW5mbyIsImR1cmF0aW9uIiwicmFkaXVzIiwicGFyc2VJbnQiLCJNYXRoIiwicmFuZG9tIiwic3RhZ2UiLCJkcmF3IiwiX3RoaXMiLCJub3ciLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyIsIl9kaWRJdGVyYXRvckVycm9yMyIsIl9pdGVyYXRvckVycm9yMyIsIl9zdGVwMyIsIl9sb29wIiwidGltZSIsImVhc2VPdXRRdWludCIsImRhc2hvZmZzZXQiLCJzZXRUaW1lb3V0IiwicmVtb3ZlQ2hpbGQiLCJfaXRlcmF0b3IzIiwid2luZG93IiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiYmluZCIsImxvbiIsImxhdCIsInQiLCJiIiwiYyIsInNpbiIsIlBJIiwiQXR0YWNrTGlzdCIsIl9SZWFjdCRDb21wb25lbnQiLCJhcHBseSIsImFyZ3VtZW50cyIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb240IiwiX2RpZEl0ZXJhdG9yRXJyb3I0IiwiX2l0ZXJhdG9yRXJyb3I0IiwiX3N0ZXA0IiwiX2l0ZXJhdG9yNCIsImxpc3QiLCJwdXNoIiwiUmVhY3QiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwic29ydCIsImEiLCJzbGljZSIsIm1hcCIsIml0ZW0iLCJDb21wb25lbnQiLCJSZWFsVGltZUxpc3QiLCJfUmVhY3QkQ29tcG9uZW50MiIsInJlYWx0aW1lIiwiVGltZSIsIk9yaWdpbiIsIlRhcmdldHMiLCJUeXBlIiwiSW5mbyIsIl9SZWFjdCRDb21wb25lbnQzIiwib3JpZ2luIiwidGFyZ2V0cyIsInF1ZXJ5U2VsZWN0b3IiLCJzY3JlZW4iLCJ3cyIsIldlYlNvY2tldCIsIm9ubWVzc2FnZSIsImUiLCJkYXRhIiwiSlNPTiIsInBhcnNlIiwib3JpQ291bnRyeSIsInRhckNvdW50cnkiLCJ0b0xvY2FsZVN0cmluZyIsInNlcnZpY2VzIiwic2hpZnQiLCJyZW5kZXIiLCJ0cmlnZ2VyIl0sIm1hcHBpbmdzIjoiQUFBQSxZQU1BLFNBQVNBLFdBQVVDLEVBQVVDLEdBQWMsR0FBMEIsa0JBQWZBLElBQTRDLE9BQWZBLEVBQXVCLEtBQU0sSUFBSUMsV0FBVSxpRUFBb0VELEdBQWVELEdBQVNHLFVBQVlDLE9BQU9DLE9BQU9KLEdBQWNBLEVBQVdFLFdBQWFHLGFBQWVDLE1BQU9QLEVBQVVRLFlBQVksRUFBT0MsVUFBVSxFQUFNQyxjQUFjLEtBQWVULElBQVlHLE9BQU9PLGVBQWlCUCxPQUFPTyxlQUFlWCxFQUFVQyxHQUFjRCxFQUFTWSxVQUFZWCxHQUVqZSxRQUFTWSxpQkFBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSWIsV0FBVSxxQ0FOaEgsR0FBSWMsTUFBTyxTQUFhQyxFQUFJQyxFQUFLQyxHQUFxQyxJQUE5QixHQUFJQyxJQUFTLEVBQXdCQSxHQUFRLENBQUUsR0FBSUMsR0FBU0osRUFBSUssRUFBV0osRUFBS0ssRUFBV0osQ0FBS0ssR0FBT0MsRUFBU0MsRUFBU0MsT0FBV1AsR0FBUyxFQUFzQixPQUFYQyxJQUFpQkEsRUFBU08sU0FBU3pCLFVBQVcsSUFBSXFCLEdBQU9wQixPQUFPeUIseUJBQXlCUixFQUFRQyxFQUFXLElBQWFLLFNBQVRILEVBQUosQ0FBaU4sR0FBSSxTQUFXQSxHQUFRLE1B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QUVBeEYsR0FDQTZDLEtBQUEyQyxFQUFBLFVBQ0E1QyxLQUFBNEMsRUFBQSxZQUVBRyxFQUFBdEgsU0FBQWMsS0FBQXFHLEVBQUEsY0FBQSxRQUNBUixRQUFBVyxHQUFBWCxPQUFBVyxLQUFBWCxPQUFBVyxHQUFBLENBQ0EsSUFBQUMsR0FBQXZILFNBQUFjLEtBQUFxRyxFQUFBLGVBQUEsUUFDQVAsU0FBQVcsR0FBQVgsUUFBQVcsS0FBQVgsUUFBQVcsR0FBQSxFQUVBbkIsU0FBQVosTUFDQWEsTUFBQSxHQUFBdkUsT0FBQTBGLGlCQUNBbEIsT0FBQWdCLEVBQ0FmLFFBQUFnQixFQUNBZixLQUFBaUIsU0FBQU4sRUFBQSxRQUFBLFdBR0FmLFNBQUExSCxPQUFBLEdBQUEwSCxTQUFBc0IsUUFFQWpDLE1BQUFrQyxPQUNBbEMsTUFBQUMsY0FBQWUsTUFBQWQsVUFBQSxPQUFBZ0IsT0FBQUEsT0FBQUMsUUFBQUEsUUFBQVIsU0FBQUEsV0FDQWIsTUFFQVEsSUFBQTZCLFFBQUFsRyxFQUFBQyIsImZpbGUiOiJtYXAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XHJcbmNsYXNzIE1hcCB7XHJcbiAgICBjb25zdHJ1Y3RvcihvcHRpb24pIHtcclxuICAgICAgICB0aGlzLnNjYWxlID0gb3B0aW9uLndpZHRoIC8gMTAwMDtcclxuICAgICAgICB0aGlzLnN2ZyA9IHRoaXMuY3JlYXRlU1ZHRWxlbWVudCgnc3ZnJywge1xyXG4gICAgICAgICAgICB3aWR0aDogb3B0aW9uLndpZHRoLFxyXG4gICAgICAgICAgICBoZWlnaHQ6IG9wdGlvbi5oZWlnaHRcclxuICAgICAgICB9KTtcclxuICAgICAgICBvcHRpb24uY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuc3ZnKTtcclxuICAgICAgICBmb3IgKGxldCBjb3VudHJ5IG9mIE9iamVjdC5rZXlzKG9wdGlvbi53b3JsZG1hcC5zaGFwZXMpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhdGggPSB0aGlzLmNyZWF0ZVNWR0VsZW1lbnQoJ3BhdGgnLCB7XHJcbiAgICAgICAgICAgICAgICBzdHJva2U6IFwiI2NjYzZhZVwiLFxyXG4gICAgICAgICAgICAgICAgZmlsbDogXCIjMDAwXCIsXHJcbiAgICAgICAgICAgICAgICBkOiBvcHRpb24ud29ybGRtYXAuc2hhcGVzW2NvdW50cnldLFxyXG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtOiBgc2NhbGUoJHsgdGhpcy5zY2FsZSB9KWBcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuc3ZnLmFwcGVuZENoaWxkKHBhdGgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSB7fTtcclxuICAgICAgICB0aGlzLmNvdW50ID0gMDsvLyBxdWV1ZeaAu+aVsFxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU1ZHRWxlbWVudFxyXG4gICAgICogQHBhcmFtICB7U3RyaW5nfSBuYW1lXHJcbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9IGF0dHJcclxuICAgICAqIEByZXR1cm4ge0VsZW1lbnR9XHJcbiAgICAgKi9cclxuICAgIGNyZWF0ZVNWR0VsZW1lbnQobmFtZSwgYXR0cikge1xyXG4gICAgICAgIGxldCBlbGUgPSAgZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsIG5hbWUpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNldEF0dHIoZWxlLCBhdHRyKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIHNldCBhdHRyXHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZVxyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGF0dHJcclxuICAgICAqL1xyXG4gICAgc2V0QXR0cihlbGUsIGF0dHIpIHtcclxuICAgICAgICBmb3IobGV0IGtleSBvZiBPYmplY3Qua2V5cyhhdHRyKSkge1xyXG4gICAgICAgICAgICBlbGUuc2V0QXR0cmlidXRlKGtleSwgYXR0cltrZXldKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGVsZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOinpuWPkeWKqOeUu1xyXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSBzdGFydFxyXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSBlbmRcclxuICAgICAqIEByZXR1cm4ge251bGx9XHJcbiAgICAgKi9cclxuICAgIHRyaWdnZXIoc3RhcnQsIGVuZCkge1xyXG4gICAgICAgIHN0YXJ0ID0gdGhpcy5nZXRYWShzdGFydCk7XHJcbiAgICAgICAgZW5kID0gdGhpcy5nZXRYWShlbmQpO1xyXG4gICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9ICtuZXcgRGF0ZTtcclxuICAgICAgICBjb25zdCBzdGFydENvbG9yID0gJyMyMWIzODQnO1xyXG4gICAgICAgIGNvbnN0IGVuZENvbG9yID0gJyNlMzI1MjgnO1xyXG4gICAgICAgIGlmKHRoaXMuY29udGFpbmVyW3RpbWVzdGFtcF0pIHJldHVybjsvLyDml6DlpYhcclxuICAgICAgICBsZXQgb3B0aW9uID0ge1xyXG4gICAgICAgICAgICAnc3Ryb2tlLXdpZHRoJzogMixcclxuICAgICAgICAgICAgJ2ZpbGw6JzogJ25vbmUnLFxyXG4gICAgICAgICAgICByOiAwLFxyXG4gICAgICAgICAgICBvcGFjaXR5OiAxXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBzdGFydENpcmNsZSA9IHRoaXMuY3JlYXRlU1ZHRWxlbWVudCgnY2lyY2xlJywgb3B0aW9uKTtcclxuICAgICAgICBsZXQgZW5kQ2lyY2xlID0gdGhpcy5jcmVhdGVTVkdFbGVtZW50KCdjaXJjbGUnLCBvcHRpb24pO1xyXG4gICAgICAgIG9wdGlvbiA9IHtcclxuICAgICAgICAgICAgc3Ryb2tlOiBlbmRDb2xvcixcclxuICAgICAgICAgICAgJ3N0cm9rZS13aWR0aCc6IDUsXHJcbiAgICAgICAgICAgIG9wYWNpdHk6IDAuNSxcclxuICAgICAgICAgICAgJ3N0cm9rZS1saW5lY2FwJzogJ3JvdW5kJyxcclxuICAgICAgICAgICAgZDogYE0keyBzdGFydC5jeCB9ICR7IHN0YXJ0LmN5IH0gTCR7IGVuZC5jeCB9ICR7IGVuZC5jeSB9YFxyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgbGluZSA9IHRoaXMuY3JlYXRlU1ZHRWxlbWVudCgncGF0aCcsIG9wdGlvbik7XHJcbiAgICAgICAgY29uc3QgdG90YWxMZW5ndGggPSBsaW5lLmdldFRvdGFsTGVuZ3RoKCk7XHJcbiAgICAgICAgdGhpcy5zZXRBdHRyKGxpbmUsIHtcclxuICAgICAgICAgICAgJ3N0cm9rZS1kYXNoYXJyYXknOiB0b3RhbExlbmd0aCxcclxuICAgICAgICAgICAgJ3N0cm9rZS1kYXNob2Zmc2V0JzogdG90YWxMZW5ndGhcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnNldEF0dHIoc3RhcnRDaXJjbGUsIHtcclxuICAgICAgICAgICAgc3Ryb2tlOiBzdGFydENvbG9yLFxyXG4gICAgICAgICAgICBjeDogc3RhcnQuY3gsXHJcbiAgICAgICAgICAgIGN5OiBzdGFydC5jeVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc2V0QXR0cihlbmRDaXJjbGUsIHtcclxuICAgICAgICAgICAgc3Ryb2tlOiBlbmRDb2xvcixcclxuICAgICAgICAgICAgY3g6IGVuZC5jeCxcclxuICAgICAgICAgICAgY3k6IGVuZC5jeVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3ZnLmFwcGVuZENoaWxkKHN0YXJ0Q2lyY2xlKTtcclxuICAgICAgICB0aGlzLnN2Zy5hcHBlbmRDaGlsZChlbmRDaXJjbGUpO1xyXG4gICAgICAgIHRoaXMuc3ZnLmFwcGVuZENoaWxkKGxpbmUpO1xyXG4gICAgICAgIGxldCBpbmZvID0ge1xyXG4gICAgICAgICAgICBzdGFydENpcmNsZTogc3RhcnRDaXJjbGUsXHJcbiAgICAgICAgICAgIGVuZENpcmNsZTogZW5kQ2lyY2xlLFxyXG4gICAgICAgICAgICBwYXRoOiBsaW5lLFxyXG4gICAgICAgICAgICB0b3RhbExlbmd0aDogdG90YWxMZW5ndGgsXHJcbiAgICAgICAgICAgIGR1cmF0aW9uOiAxMDAwLFxyXG4gICAgICAgICAgICByYWRpdXM6IDcwICsgcGFyc2VJbnQoTWF0aC5yYW5kb20oKSAqIDIwKSxcclxuICAgICAgICAgICAgc3RhZ2U6IDBcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb250YWluZXJbdGltZXN0YW1wXSA9IGluZm87XHJcbiAgICAgICAgaWYoISh0aGlzLmNvdW50KSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZHJhdygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOa4suafk1xyXG4gICAgICogQHJldHVybiB7bnVsbH1cclxuICAgICAqL1xyXG4gICAgZHJhdygpIHtcclxuICAgICAgICBjb25zdCBub3cgPSArbmV3IERhdGU7XHJcbiAgICAgICAgZm9yKGxldCBrZXkgb2YgT2JqZWN0LmtleXModGhpcy5jb250YWluZXIpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRpbWUgPSBub3cgLSBrZXk7XHJcbiAgICAgICAgICAgIGNvbnN0IGluZm8gPSB0aGlzLmNvbnRhaW5lcltrZXldO1xyXG4gICAgICAgICAgICBpZih0aW1lIDwgaW5mby5kdXJhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuZWFzZU91dFF1aW50KHRpbWUsIDAsIGluZm8ucmFkaXVzLCBpbmZvLmR1cmF0aW9uKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRhc2hvZmZzZXQgPSB0aGlzLmVhc2VPdXRRdWludCh0aW1lLCBpbmZvLnRvdGFsTGVuZ3RoLCAtMiAqIGluZm8udG90YWxMZW5ndGgsIGluZm8uZHVyYXRpb24pO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgb3BhY2l0eSA9IHRoaXMuZWFzZU91dFF1aW50KHRpbWUsIDEsIC0xLCBpbmZvLmR1cmF0aW9uKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0QXR0cihpbmZvLnN0YXJ0Q2lyY2xlLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgcjogcixcclxuICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiBvcGFjaXR5XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0QXR0cihpbmZvLnBhdGgsIHtcclxuICAgICAgICAgICAgICAgICAgICAnc3Ryb2tlLWRhc2hvZmZzZXQnOiBkYXNob2Zmc2V0XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmKHRpbWUgPCBpbmZvLmR1cmF0aW9uICogMikge1xyXG4gICAgICAgICAgICAgICAgaWYoaW5mby5zdGFnZSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN2Zy5yZW1vdmVDaGlsZChpbmZvLnN0YXJ0Q2lyY2xlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdmcucmVtb3ZlQ2hpbGQoaW5mby5wYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAwKTtcclxuICAgICAgICAgICAgICAgICAgICAvL3RoaXMuc3ZnLnJlbW92ZUNoaWxkKGluZm8uc3RhcnRDaXJjbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vdGhpcy5zdmcucmVtb3ZlQ2hpbGQoaW5mby5wYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICBpbmZvLnN0YWdlID0gMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmVhc2VPdXRRdWludCh0aW1lIC0gaW5mby5kdXJhdGlvbiwgMCwgaW5mby5yYWRpdXMsIGluZm8uZHVyYXRpb24pO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgb3BhY2l0eSA9IHRoaXMuZWFzZU91dFF1aW50KHRpbWUgLSBpbmZvLmR1cmF0aW9uLCAxLCAtMSwgaW5mby5kdXJhdGlvbik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldEF0dHIoaW5mby5lbmRDaXJjbGUsIHtcclxuICAgICAgICAgICAgICAgICAgICByOiByLFxyXG4gICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IG9wYWNpdHlcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLnN2Zy5yZW1vdmVDaGlsZChpbmZvLmVuZENpcmNsZSksIDApO1xyXG4gICAgICAgICAgICAgICAgLy90aGlzLnN2Zy5yZW1vdmVDaGlsZChpbmZvLmVuZENpcmNsZSk7XHJcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5jb250YWluZXJba2V5XTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY291bnQtLTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZih0aGlzLmNvdW50KSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5kcmF3LmJpbmQodGhpcykpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOe7j+e6rOW6pjJYWVxyXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSBvcHRpb25cclxuICAgICAqIEByZXR1cm4ge09iamVjdH1cclxuICAgICAqL1xyXG4gICAgZ2V0WFkgKG9wdGlvbikge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGN4OiAob3B0aW9uLmxvbiAqIDIuNjkzOCArIDQ2NS40KSAqIHRoaXMuc2NhbGUsXHJcbiAgICAgICAgICAgIGN5OiAob3B0aW9uLmxhdCAqIC0yLjY5MzggKyAyMjcuMDY2KSAqIHRoaXMuc2NhbGVcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOe8k+WKqOWHveaVsFxyXG4gICAgICogQHBhcmFtICB7TnVtYmVyfSB0IOWHhuehruaXtumXtFxyXG4gICAgICogQHBhcmFtICB7TnVtYmVyfSBiIOW8gOWni+WAvFxyXG4gICAgICogQHBhcmFtICB7TnVtYmVyfSBjIOaUueWPmOWAvFxyXG4gICAgICogQHBhcmFtICB7TnVtYmVyfSBkIOaAu+aXtumXtFxyXG4gICAgICogQHJldHVybiB7TnVtYmVyfSAgIHZhbHVlXHJcbiAgICAgKi9cclxuICAgICBlYXNlT3V0UXVpbnQgKHQsIGIsIGMsIGQpIHtcclxuIFx0XHRyZXR1cm4gYyAqIE1hdGguc2luKHQvZCAqIChNYXRoLlBJLzIpKSArIGI7XHJcbiBcdH1cclxufVxyXG4iLCJjbGFzcyBBdHRhY2tMaXN0IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBsZXQgY291bnRyeSA9IFtdO1xyXG4gICAgICAgIGZvcihsZXQga2V5IG9mIE9iamVjdC5rZXlzKHRoaXMucHJvcHMubGlzdCkpIHtcclxuICAgICAgICAgICAgY291bnRyeS5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGNvdW50cnk6IGtleSxcclxuICAgICAgICAgICAgICAgIGNvdW50OiB0aGlzLnByb3BzLmxpc3Rba2V5XVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDx0YWJsZSBjbGFzc05hbWU9eyB0aGlzLnByb3BzLmNsYXNzTmFtZSB9PlxyXG4gICAgICAgICAgICAgICAgPHRyPlxyXG4gICAgICAgICAgICAgICAgICA8dGg+eyB0aGlzLnByb3BzLmNsYXNzTmFtZSA9PSAnYXR0YWNrb3JpZ2luJyA/ICdPcmlnaW4nIDogJ1RhcmdldHMnIH08L3RoPlxyXG4gICAgICAgICAgICAgICAgICA8dGg+Q291bnQ8L3RoPlxyXG4gICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBjb3VudHJ5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiBiLmNvdW50IC0gYS5jb3VudClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnNsaWNlKDAsIDkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPnsgaXRlbS5jb3VudHJ5IH08L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPnsgaXRlbS5jb3VudCB9PC90ZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgPC90YWJsZT5cclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcblxyXG5jbGFzcyBSZWFsVGltZUxpc3QgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xyXG4gICAgcmVuZGVyICgpIHtcclxuXHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPHRhYmxlIGNsYXNzTmFtZT17IHRoaXMucHJvcHMuY2xhc3NOYW1lIH0+XHJcbiAgICAgICAgICAgICAgICA8dHI+XHJcbiAgICAgICAgICAgICAgICAgIDx0aD5UaW1lPC90aD5cclxuICAgICAgICAgICAgICAgICAgPHRoPk9yaWdpbjwvdGg+XHJcbiAgICAgICAgICAgICAgICAgIDx0aD5UYXJnZXRzPC90aD5cclxuICAgICAgICAgICAgICAgICAgPHRoPlR5cGU8L3RoPlxyXG4gICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgIHsgdGhpcy5wcm9wcy5yZWFsdGltZS5tYXAoKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8dHI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIHdpZHRoPVwiMjAwXCI+eyBpdGVtLlRpbWUgfTwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPnsgaXRlbS5PcmlnaW4gfTwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIHdpZHRoPVwiMjAwXCI+eyBpdGVtLlRhcmdldHMgfTwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPnsgaXRlbS5UeXBlIH08L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9KSB9XHJcbiAgICAgICAgICAgIDwvdGFibGU+XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxuY2xhc3MgSW5mbyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbmZvXCI+XHJcbiAgICAgICAgICAgICAgICA8QXR0YWNrTGlzdCBsaXN0PXsgdGhpcy5wcm9wcy5vcmlnaW4gfSBjbGFzc05hbWU9XCJhdHRhY2tvcmlnaW5cIiAvPlxyXG4gICAgICAgICAgICAgICAgPEF0dGFja0xpc3QgbGlzdD17IHRoaXMucHJvcHMudGFyZ2V0cyB9IGNsYXNzTmFtZT1cImF0dGFja3RhcmdldHNcIiAvPlxyXG4gICAgICAgICAgICAgICAgPFJlYWxUaW1lTGlzdCByZWFsdGltZT17IHRoaXMucHJvcHMucmVhbHRpbWUgfSBjbGFzc05hbWU9XCJyZWFsdGltZVwiIC8+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxubGV0IG1hcCA9IG5ldyBNYXAoe1xyXG4gICAgY29udGFpbmVyOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWFwJyksXHJcbiAgICB3aWR0aDogc2NyZWVuLndpZHRoLFxyXG4gICAgaGVpZ2h0OiBzY3JlZW4ud2lkdGggKiAwLjQsXHJcbiAgICB3b3JsZG1hcDogd29ybGRtYXBcclxufSk7XHJcbmxldCBsaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxpc3QnKTtcclxuXHJcbmxldCBvcmlnaW4gPSB7fSxcclxuICAgIHRhcmdldHMgPSB7fSxcclxuICAgIHJlYWx0aW1lID0gW107XHJcblxyXG5jb25zdCB3cyA9IG5ldyBXZWJTb2NrZXQoJ3dzOi8vbWJzZC5pcHZpa2luZy5jb206NDQzJyk7XHJcbndzLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGUpIHtcclxuICAgIGxldCBkYXRhID0gSlNPTi5wYXJzZShlLmRhdGEpO1xyXG4gICAgY29uc3Qgc3RhcnQgPSB7XHJcbiAgICAgICAgbGF0OiArZGF0YVsnbGF0aXR1ZGUnXSxcclxuICAgICAgICBsb246ICtkYXRhWydsb25naXR1ZGUnXVxyXG4gICAgfTtcclxuICAgIGNvbnN0IGVuZCA9IHtcclxuICAgICAgICBsYXQ6ICtkYXRhWydsYXRpdHVkZTInXSxcclxuICAgICAgICBsb246ICtkYXRhWydsb25naXR1ZGUyJ11cclxuICAgIH07XHJcbiAgICBjb25zdCBvcmlDb3VudHJ5ID0gd29ybGRtYXAubmFtZVtkYXRhWydjb3VudHJ5Y29kZSddXSB8fCAnVW5rbm93JztcclxuICAgIG9yaWdpbltvcmlDb3VudHJ5XSA/IG9yaWdpbltvcmlDb3VudHJ5XSsrIDogb3JpZ2luW29yaUNvdW50cnldID0gMTtcclxuICAgIGNvbnN0IHRhckNvdW50cnkgPSB3b3JsZG1hcC5uYW1lW2RhdGFbJ2NvdW50cnljb2RlMiddXSB8fCAnVW5rbm93JztcclxuICAgIHRhcmdldHNbdGFyQ291bnRyeV0gPyB0YXJnZXRzW3RhckNvdW50cnldKysgOiB0YXJnZXRzW3RhckNvdW50cnldID0gMTtcclxuXHJcbiAgICByZWFsdGltZS5wdXNoKHtcclxuICAgICAgICBUaW1lOiBuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCksXHJcbiAgICAgICAgT3JpZ2luOiBvcmlDb3VudHJ5LFxyXG4gICAgICAgIFRhcmdldHM6IHRhckNvdW50cnksXHJcbiAgICAgICAgVHlwZTogc2VydmljZXNbZGF0YVsnZHBvcnQnXV0gfHwgJ1Vua25vdydcclxuICAgIH0pO1xyXG5cclxuICAgIGlmKHJlYWx0aW1lLmxlbmd0aCA+IDgpIHJlYWx0aW1lLnNoaWZ0KCk7XHJcblxyXG4gICAgUmVhY3QucmVuZGVyKFxyXG4gICAgICAgIDxJbmZvIGNsYXNzTmFtZT1cImluZm9cIiBvcmlnaW49eyBvcmlnaW4gfSB0YXJnZXRzPXsgdGFyZ2V0cyB9IHJlYWx0aW1lPXsgcmVhbHRpbWUgfSAvPixcclxuICAgICAgICBsaXN0KTtcclxuXHJcbiAgICBtYXAudHJpZ2dlcihzdGFydCwgZW5kKTtcclxufTtcclxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9